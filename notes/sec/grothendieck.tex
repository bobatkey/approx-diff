\subsection{Category of families}

\begin{definition}[Grothendieck construction for $F$]
Suppose a functor $F: D \to \Cat$. The \emph{Grothendieck construction} $\Grothendieck{D}F$ for $F$ is the
category where:
\begin{itemize}
\item objects $X$ are pairs of an object $\idx{X}$ of $D$ and an object $\faml{X}$ of $F(\idx{X})$;
\item morphisms $f: X \to Y$ are morphisms $\idx{f}: \idx{X} \to \idx{Y}$ in $D$ paired with morphisms
$\faml{f}: F(f)(\faml{X}) \to \faml{Y}$ in $F(\idx{Y})$.
\end{itemize}
\end{definition}

\noindent When $F$ is contravariant, a morphism $f: X \to Y$ is a morphism $\idx{f}: \idx{X} \to \idx{Y}$ in
$D$ paired with morphisms $\faml{f}: \faml{X} \to F(f)(\faml{Y})$ in $F(\idx{X})$.

\begin{definition}[Category of families]
For any category $C$ define $\Fam(C)$ to be the Grothendieck construction
$\Grothendieck{\Set^{\op}}\Fam(-,C)$.
\end{definition}

\noindent In $\Fam(C)$ the objects $X$ are thus sets $\idx{X}$ paired with indexed families $\faml{X}$ in
$\Fam(\idx{X},C)$ and morphisms $f: X \to Y$ are functions $\idx{f}: \idx{X} \to \idx{Y}$ paired with
morphisms $\faml{f}: \faml{X} \to \reindex{\faml{Y}}{\idx{f}}$ in $\Fam(\idx{X},C)$.

\begin{proposition}
\item
\begin{enumerate}
\item If $C$ is locally small then so is $\Fam(C)$.
\item If $C$ has binary products then so does $\Fam(C)$.
\end{enumerate}
\end{proposition}

The following is a special case of a construction due to \citet{nunes2023}:

\begin{proposition}
Suppose $C$ locally small. If $C$ has binary biproducts and set-indexed products, then $\Fam(C)$ is Cartesian
closed. \todo{Establish first that if $C$ has binary coproducts and set-indexed products,
then $\Fam(C)$ is symmetric monoidal, with the coproduct as monoidal product.}
\end{proposition}

\begin{proof}
Suppose $C$ is locally small, with binary biproducts given by $(\biprod,\inj,\proj)$ and set-indexed products
given by $(\prod,\eval_{\prod},\lambda_{\prod})$. For any objects $X, Y, Z$ in $\Fam(C)$ define:

\begin{enumerate}
\item $[X, Y]$ to be the object $(X',Y')$ in $\Fam(C)$ with $X' = \Fam(C)(X,Y)$ and $Y'_f =
\prod_{\idx{X}}\reindex{\faml{Y}}{\idx{f}}$ for every $f: X \to Y$.
\item The family of isomorphisms $\lambda_{X,Y,Z}$ (natural in $X$) sending any $(f, g): X \times Y \to Z$ to
$(f', g'): X \to [Y, Z]$ with:
\begin{itemize}
\item $f'(x) = (f \comp (x, -), \reindex{g}{(x,-)} \comp \inj_{\faml{Y}}):
Y \to Z$ where $\inj_{\faml{Y}}: \faml{Y} \to \const_{\idx{Y}}(\faml{X}_x) \biprod \faml{Y}$
\item $g'_x = \lambda_{\prod_{\idx{Y}}}(\reindex{g}{(x,-)} \comp \inj_{\faml{X}_x}:
\const_{\idx{Y}}(\faml{X}_x) \to \reindex{\faml{Z}}{f})$ where $\inj_{\faml{X}_x}: \const_{\idx{Y}}(\faml{X}_x)
\to \const_{\idx{Y}}(\faml{X}_x) \biprod \faml{Y}$
\end{itemize}
\item The family of morphisms $\eval_{X,Y} = (f',g'): [X, Y] \times X \to Y$ in $\Fam(C)$ with
\begin{itemize}
\item $f'((f, g), x) = f(x)$
\item $g'_{(f,g), x} = \coprodM{{\eval_{\prod}}_x}{g_x}:
\prod_{\idx{X}}\reindex{\faml{Y}}{f} \biprod \faml{X}_x \to \faml{Y}_{f(x)}$
\end{itemize}
\end{enumerate}

Then:

\begin{enumerate}
\item Define the family of functions $\lambda^{-1}_{X,Y,Z}$ sending any $(f,g): X \to [Y,Z]$ to $(f^\dagger,
g^\dagger): X \times Y \to Z$ with:
\begin{itemize}
\item $f^\dagger(x,y) = f'(y)$
\item $g^\dagger_{x,y} = \coprodM{{\eval_{\prod}}_y \comp g_x}{g'_y}$
% $g'_y \comp \proj_{\faml{Y}_y}$ where $f(x) = (f',g')$ and $\proj_{\faml{Y}_y}: \faml{X}_x \biprod
% \faml{Y}_y \to \faml{Y}_y$
\end{itemize}
\noindent where $f(x) = (f',g')$.

\todo{Show $\lambda^{-1}_{X,Y,Z}(\lambda_{X,Y,Z}(f)) = f$ and $\lambda_{X,Y,Z}(\lambda^{-1}_{X,Y,Z}(f)) =
f$}.

\item Suppose $f: X \times Y \to Z$ in $\Fam(C)$ and $(x, y) \in \idx{X} \times \idx{Y}$. The diagram on the
left below commutes by the universal property of the set-indexed product; the commutativity of the diagram on
the right is trivial.

\begin{center}
\begin{tikzcd}
   \prod_{\idx{Y}}\reindex{\faml{Z}}{\idx{f} \comp (x,-)} \arrow[dr, "\eval_{\prod_{y}}"] \\
   \faml{X}_x \arrow[u, "\lambda_{\prod_{\idx{Y}}}(\reindex{\faml{f}}{{(x,-)}}\,\comp\,
\inj_{\faml{X}_x})"] \arrow[r, "\faml{f}_{x,y}\,\comp\,\inj_{\faml{X}_x}"'] & \faml{Z}_{\idx{f}(x,y)}
\end{tikzcd}
\hspace{1cm}
\begin{tikzcd}[column sep=5em]
   \faml{Y}_y \arrow[dr,
   "\faml{f}_{(x,y)}\,\comp\,\inj_{\faml{Y}_y}"] \\
   \faml{Y}_y \arrow[u, -, double, "\id_{\faml{Y}_y}"] \arrow[r, "\faml{f}_{x,y}\,\comp\,\inj_{\faml{Y}_y}"'] & \faml{Z}_{\idx{f}(x,y)}
\end{tikzcd}
\end{center}

The diagram on the left below then commutes by Proposition~\ref{prop:biproduct:prod-coprod}, with
$\coprodM{\faml{f}_{x,y}\,\comp\,\inj_{\faml{X}_x}}{\faml{f}_{x,y}\,\comp\,\inj_{\faml{Y}_y}} =
\faml{f}_{(x,y)}$ by the uniqueness of the coproduct of morphisms. Then the diagram on the right in $\Fam(C)$
commutes by the definitions of $\lambda_{X,Y,Z}, \eval_{Y,Z}$ and $[Y,Z]$.

\begin{center}
\begin{tikzcd}[column sep=5.5em]
   \prod_{\idx{Y}}\reindex{\faml{Z}}{\idx{f} \comp (x,-)} \biprod \faml{Y}_y \arrow[dr,
   "\coprodM{\eval_{\prod_{y}}}{\faml{f}_{(x,y)}\,\comp\,\inj_{\faml{Y}_y}}"] \\
   \faml{X}_x \biprod \faml{Y}_y \arrow[u, "(\lambda_{\prod_{\idx{Y}}}(\reindex{\faml{f}}{{(x,-)}}\,\comp\,
\inj_{\faml{X}_x}){,}\,\id_{\faml{Y}_y})"] \arrow[r,
"\coprodM{\faml{f}_{x,y}\,\comp\,\inj_{\faml{X}_x}}{\faml{f}_{x,y}\,\comp\,\inj_{\faml{Y}_y}}"'] &
\faml{Z}_{\idx{f}(x,y)}
\end{tikzcd}
\hspace{1cm}
\begin{tikzcd}
   {{[Y, Z]}} \tensor Y \arrow[dr, "\eval_{Y,Z}"] \\
   X \tensor Y \arrow[u, "\lambda_{X,Y,Z}(f) \tensor \id_Y"] \arrow[r, "f"'] & Z
\end{tikzcd}
\end{center}
\end{enumerate}
\end{proof}
